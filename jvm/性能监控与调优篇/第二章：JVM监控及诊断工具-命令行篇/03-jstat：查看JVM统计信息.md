## 基本情况

jstat( JVM Statistics Monitoring TooL):用于监视虛拟机各种运行状态信息的命令行工具。它可以是示本地或者远程虚拟机进程中的类装载、内存、垃圾收集、JIT编译等运行数据。

在没有GUI图形界面，只提供了纯文本控制台环境的服务器上，它将是运行期定位虚拟机性能问题的首选工具。常用于检测垃圾回收问题以及内存泄漏问题。


## 基本语法

![image-20210408211203706](https://github.com/MrL5z2k0/zkNode/tree/main/images/image-20210408211203706.png)

### option参数

选项option可以由以下值构成。

**类装载相关的**：

- -class:显示ClassLoaderl的相关信息：类的装载、卸载数量、总空间、类装载所消耗的时间等。

**垃圾回收相关的：**

- -gc: 显示与Gc相关的堆信息。包括Eden区、两个Survivor区、老年代永久代等的容量、已用空间、GC时间合计等信息。
- -gccapacity:显示内容与-gc基本相同，但输出主要关注Java堆各个区域使用到的最大、最小空间。
- -gcutil:显示内容与-gc基本相同，但输出主要关注己使用空间占总空间的百分比。
- -gccause:与-gutil功能一样，但是会额外输出导致最后一次或当前正在发生的GC产生的原因。
- -gcnew:显示新生代GC状况。
- -gcnewcapacity:显示内容与-gcnew基本相同，输出主要关注使用到的最大、最小空间。
- -geold:显示老年代GC状况

**JIT相关的：**

- -compiler: 显示JIT编译器编译过的方法、耗时等信息
- -printcompilation:输出已经被JIT编译的方法

我们可以比较Java进程的启动时间以及总GC时间(GCT列)，或者两次测量的间隔时间以及总GC时间的增量，来得出GC时间占运行时间的比例。

如果该比例超过20%,则说明目前堆的压力较大：如果该比例超过90%,则说明堆里几乎没有可用空间，随时都可能抛出OOM异常。



jstat还可以用来判断是否出现内存泄漏。

第1步：
在长时间运行的Java程序中，我们可以运行jstat命令连续获取多行性能数据，并取这几行数据中OU列（即已占用的老年代内存）的最小值.

第2步:
然后，我们每隔一段较长的时间重复一次上述操作，来获得多组OU最小值。如果这些值呈上涨趋势。则说明该Java程序的老年代内存己使用量在不断上涨，这意味着无法回收的对象在不断增加，因此很有可能存在存泄漏。
